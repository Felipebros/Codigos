<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferramentas de Cálculo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .calculators {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .calculator {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        h2 {
            color: #3498db;
            margin-top: 0;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        label {
            font-weight: bold;
        }
        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background-color: #2980b9;
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            background-color: #eee;
            border-radius: 4px;
            display: none;
        }
        .result-container {
            display: flex;
            align-items: center;
            margin-top: 15px;
            gap: 10px;
        }
        .result-input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            font-weight: bold;
            cursor: default;
        }
        .copy-button {
            background-color: #27ae60;
            padding: 8px 12px;
        }
        .copy-button:hover {
            background-color: #219653;
        }
    </style>
</head>
<body>
    <a href="https://felipebros.github.io/Codigos/">Página Inicial</a>
    | <a href="./calculadora_porcentagem.html">Site</a>
    | <a href="https://github.com/Felipebros/Codigos/blob/main/src/calculadora_porcentagem.html">Repositório</a>


    <h1>Ferramentas de Cálculo</h1>
    
    <div class="calculators">
        <div class="calculator">
            <h2>Regra de Três</h2>
            <form id="ruleOfThree">
                <style>
                    .rule-of-three-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        grid-template-rows: auto auto;
                        gap: 10px;
                        margin-bottom: 15px;
                        align-items: center;
                    }
                    .rule-of-three-grid .x-label {
                        grid-column: 2;
                        grid-row: 2;
                        text-align: center;
                        font-weight: bold;
                    }
                    .rule-of-three-grid .separator {
                        grid-column: 1 / span 2;
                        text-align: center;
                        height: 2px;
                        background-color: #ddd;
                        margin: 5px 0;
                    }
                </style>
                <div class="rule-of-three-grid">
                    <div>
                        <label for="a">Valor:</label>
                        <input type="number" id="a" step="any">
                    </div>
                    <div>
                        <label for="b">%:</label>
                        <input type="number" id="b" step="any">
                    </div>
                    <div>
                        <label for="c">Valor:</label>
                        <input type="number" id="c" step="any">
                    </div>
                    <div>
                        <label for="d">%:</label>
                        <input type="number" id="d" step="any">
                    </div>
                </div>
                <button type="submit">Calcular</button>
            </form>
            <div id="ruleOfThreeResult" class="result"></div>
            <div class="result-container" style="display:none" id="ruleOfThreeResultContainer">
                <input type="text" id="ruleOfThreeResultInput" class="result-input" readonly>
                <button id="ruleOfThreeCopyButton" class="copy-button">Copiar</button>
            </div>
        </div>
        
        <div class="calculator">
            <h2>Calcular Porcentagem de Aumento/Diminuição</h2>
            <form id="percentageChange">
                <div>
                    <label for="originalValue">Valor Original:</label>
                    <input type="number" id="originalValue" step="any" required>
                </div>
                <div>
                    <label for="newValue">Valor Novo:</label>
                    <input type="number" id="newValue" step="any" required>
                </div>
                <button type="submit">Calcular Porcentagem</button>
            </form>
            <div id="percentageChangeResult" class="result"></div>
            <div class="result-container" style="display:none" id="percentageChangeResultContainer">
                <input type="text" id="percentageChangeResultInput" class="result-input" readonly>
                <button id="percentageChangeCopyButton" class="copy-button">Copiar</button>
            </div>
            <label id="finalValueLabel" style="display:none; margin-top: 15px; font-weight: bold;">Valor com ajuste:</label>
            <div class="result-container" style="display:none" id="percentageChangeFinalValueContainer">
                <input type="text" id="percentageChangeFinalValueInput" class="result-input" readonly>
                <button id="percentageChangeFinalValueCopyButton" class="copy-button">Copiar</button>
            </div>
        </div>
        
        <div class="calculator">
            <h2>Calcular Valor da Porcentagem</h2>
            <form id="percentageValue">
                <div>
                    <label for="totalValue">Valor Total:</label>
                    <input type="number" id="totalValue" step="any" required>
                </div>
                <div>
                    <label for="percentageRate">Porcentagem (%):</label>
                    <input type="number" id="percentageRate" step="any" required>
                </div>
                <button type="submit">Calcular Valor</button>
            </form>
            <div id="percentageValueResult" class="result"></div>
            <div class="result-container" style="display:none" id="percentageValueResultContainer">
                <input type="text" id="percentageValueResultInput" class="result-input" readonly>
                <button id="percentageValueCopyButton" class="copy-button">Copiar</button>
            </div>
            <label id="percentageValueTotalLabel" style="display:none; margin-top: 15px; font-weight: bold;">Valor total com a porcentagem:</label>
            <div class="result-container" style="display:none" id="percentageValueTotalContainer">
                <input type="text" id="percentageValueTotalInput" class="result-input" readonly>
                <button id="percentageValueTotalCopyButton" class="copy-button">Copiar</button>
            </div>
        </div>
        
        <div class="calculator">
            <h2>Calcular Valor Original</h2>
            <form id="originalValueCalculator">
                <div>
                    <label for="percentageAdjustment">Porcentagem de Ajuste (%):</label>
                    <input type="number" id="percentageAdjustment" step="any" required>
                </div>
                <div>
                    <label for="adjustedValue">Valor Após Ajuste:</label>
                    <input type="number" id="adjustedValue" step="any" required>
                </div>
                <div>
                    <label>Tipo de Ajuste:</label>
                    <div style="display: flex; gap: 20px; margin-top: 5px;">
                        <div>
                            <input type="radio" id="increase" name="adjustmentType" value="increase" checked>
                            <label for="increase">Aumento</label>
                        </div>
                        <div>
                            <input type="radio" id="decrease" name="adjustmentType" value="decrease">
                            <label for="decrease">Diminuição</label>
                        </div>
                    </div>
                </div>
                <button type="submit">Calcular Valor Original</button>
            </form>
            <div id="originalValueResult" class="result"></div>
            <div class="result-container" style="display:none" id="originalValueResultContainer">
                <input type="text" id="originalValueResultInput" class="result-input" readonly>
                <button id="originalValueCopyButton" class="copy-button">Copiar</button>
            </div>
        </div>
    </div>

    <script>
        // Função para formatar número (inteiro ou decimal com vírgula)
        function formatNumber(value) {
            // Verificar se é um número inteiro
            if (Number.isInteger(parseFloat(value)) || Math.floor(value) === value) {
                // Retornar como inteiro
                return Math.round(value).toString();
            } else {
                // Retornar com 2 casas decimais e vírgula como separador
                return value.toFixed(2).replace('.', ',');
            }
        }
        
        // Função para copiar para área de transferência
        function copyToClipboard(text, buttonEl) {
            navigator.clipboard.writeText(text).then(function() {
                // Feedback visual
                const originalText = buttonEl.textContent;
                buttonEl.textContent = 'Copiado!';
                setTimeout(() => {
                    buttonEl.textContent = originalText;
                }, 2000);
            }).catch(function() {
                alert('Não foi possível copiar o valor. Por favor, tente novamente.');
            });
        }

        // Regra de Três
        document.getElementById('ruleOfThree').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Pegar valores dos campos
            const aInput = document.getElementById('a');
            const bInput = document.getElementById('b');
            const cInput = document.getElementById('c');
            const dInput = document.getElementById('d');
            
            // Verificar quais campos estão preenchidos
            const aValue = aInput.value !== '' ? parseFloat(aInput.value) : null;
            const bValue = bInput.value !== '' ? parseFloat(bInput.value) : null;
            const cValue = cInput.value !== '' ? parseFloat(cInput.value) : null;
            const dValue = dInput.value !== '' ? parseFloat(dInput.value) : null;
            
            // Contar quantos campos estão preenchidos
            const filledFields = [aValue, bValue, cValue, dValue].filter(value => value !== null).length;
            
            const resultElement = document.getElementById('ruleOfThreeResult');
            const resultContainer = document.getElementById('ruleOfThreeResultContainer');
            const resultInput = document.getElementById('ruleOfThreeResultInput');
            
            // Verificar se exatamente 3 campos estão preenchidos
            if (filledFields !== 3) {
                resultElement.innerHTML = '<strong>Erro:</strong> Preencha exatamente 3 campos para calcular o quarto valor.';
                resultElement.style.display = 'block';
                resultContainer.style.display = 'none';
                return;
            }
            
            let result;
            let fieldName = '';
            
            // Calcular o campo que falta
            if (aValue === null) {
                // Calcular a
                result = (cValue * bValue) / dValue;
                fieldName = 'Valor A';
            } else if (bValue === null) {
                // Calcular b
                result = (dValue * aValue) / cValue;
                fieldName = 'Porcentagem B';
            } else if (cValue === null) {
                // Calcular c
                result = (aValue * dValue) / bValue;
                fieldName = 'Valor C';
            } else if (dValue === null) {
                // Calcular d
                result = (bValue * cValue) / aValue;
                fieldName = 'Porcentagem D';
            }
            
            const resultFormatted = formatNumber(result);
            resultElement.innerHTML = `<strong>Resultado:</strong> ${fieldName} = ${resultFormatted}`;
            resultElement.style.display = 'block';
            
            // Atualizar o campo de resultado
            resultInput.value = resultFormatted;
            resultContainer.style.display = 'flex';
        });
        
        // Botão de cópia para Regra de Três
        document.getElementById('ruleOfThreeCopyButton').addEventListener('click', function() {
            const resultInput = document.getElementById('ruleOfThreeResultInput');
            copyToClipboard(resultInput.value, this);
        });
        
        // Cálculo de Porcentagem de Aumento/Diminuição
        document.getElementById('percentageChange').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const originalValue = parseFloat(document.getElementById('originalValue').value);
            const newValue = parseFloat(document.getElementById('newValue').value);
            
            const difference = newValue - originalValue;
            const percentageChange = (difference / originalValue) * 100;
            
            const resultElement = document.getElementById('percentageChangeResult');
            const resultContainer = document.getElementById('percentageChangeResultContainer');
            const resultInput = document.getElementById('percentageChangeResultInput');
            const finalValueLabel = document.getElementById('finalValueLabel');
            const finalValueContainer = document.getElementById('percentageChangeFinalValueContainer');
            const finalValueInput = document.getElementById('percentageChangeFinalValueInput');
            
            let resultText = '';
            let resultValue = '';
            
            if (percentageChange > 0) {
                resultText = `<strong>Resultado:</strong> Houve um aumento de ${formatNumber(percentageChange)}%`;
                resultValue = formatNumber(percentageChange);
            } else if (percentageChange < 0) {
                resultText = `<strong>Resultado:</strong> Houve uma diminuição de ${formatNumber(Math.abs(percentageChange))}%`;
                resultValue = formatNumber(Math.abs(percentageChange));
            } else {
                resultText = `<strong>Resultado:</strong> Não houve alteração de valor (0%)`;
                resultValue = '0';
            }
            
            resultElement.innerHTML = resultText;
            resultElement.style.display = 'block';
            
            // Atualizar o campo de resultado da porcentagem
            resultInput.value = resultValue;
            resultContainer.style.display = 'flex';
            
            // Atualizar o campo de valor final
            finalValueLabel.style.display = 'block';
            finalValueContainer.style.display = 'flex';
            finalValueInput.value = formatNumber(newValue);
        });
        
        // Botão de cópia para Porcentagem de Aumento/Diminuição
        document.getElementById('percentageChangeCopyButton').addEventListener('click', function() {
            const resultInput = document.getElementById('percentageChangeResultInput');
            copyToClipboard(resultInput.value, this);
        });
        
        // Cálculo do Valor da Porcentagem
        document.getElementById('percentageValue').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const totalValue = parseFloat(document.getElementById('totalValue').value);
            const percentageRate = parseFloat(document.getElementById('percentageRate').value);
            
            const result = (totalValue * percentageRate) / 100;
            const totalWithPercentage = totalValue + result;
            
            const resultElement = document.getElementById('percentageValueResult');
            const resultContainer = document.getElementById('percentageValueResultContainer');
            const resultInput = document.getElementById('percentageValueResultInput');
            const totalLabel = document.getElementById('percentageValueTotalLabel');
            const totalContainer = document.getElementById('percentageValueTotalContainer');
            const totalInput = document.getElementById('percentageValueTotalInput');
            
            resultElement.innerHTML = `<strong>Resultado:</strong> ${formatNumber(percentageRate)}% de R$ ${formatNumber(totalValue)} é R$ ${formatNumber(result)}`;
            resultElement.style.display = 'block';
            
            // Atualizar o campo de resultado da porcentagem
            resultInput.value = formatNumber(result);
            resultContainer.style.display = 'flex';
            
            // Atualizar o campo de valor total com a porcentagem
            totalLabel.style.display = 'block';
            totalContainer.style.display = 'flex';
            totalInput.value = formatNumber(totalWithPercentage);
        });
        
        // Botão de cópia para Valor da Porcentagem
        document.getElementById('percentageValueCopyButton').addEventListener('click', function() {
            const resultInput = document.getElementById('percentageValueResultInput');
            copyToClipboard(resultInput.value, this);
        });
        
        // Botão de cópia para valor total com a porcentagem
        document.getElementById('percentageValueTotalCopyButton').addEventListener('click', function() {
            const totalInput = document.getElementById('percentageValueTotalInput');
            copyToClipboard(totalInput.value, this);
        });
        
        // Botão de cópia para valor com ajuste
        document.getElementById('percentageChangeFinalValueCopyButton').addEventListener('click', function() {
            const finalValueInput = document.getElementById('percentageChangeFinalValueInput');
            copyToClipboard(finalValueInput.value, this);
        });
        
        // Cálculo do Valor Original a partir da porcentagem e valor ajustado
        document.getElementById('originalValueCalculator').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const percentageAdjustment = parseFloat(document.getElementById('percentageAdjustment').value);
            const adjustedValue = parseFloat(document.getElementById('adjustedValue').value);
            const isIncrease = document.getElementById('increase').checked;
            
            let originalValue;
            
            if (isIncrease) {
                // Para aumento: valor_original = valor_ajustado / (1 + porcentagem/100)
                originalValue = adjustedValue / (1 + percentageAdjustment / 100);
            } else {
                // Para diminuição: valor_original = valor_ajustado / (1 - porcentagem/100)
                originalValue = adjustedValue / (1 - percentageAdjustment / 100);
            }
            
            const resultElement = document.getElementById('originalValueResult');
            const resultContainer = document.getElementById('originalValueResultContainer');
            const resultInput = document.getElementById('originalValueResultInput');
            
            const adjustmentType = isIncrease ? "aumento" : "diminuição";
            
            resultElement.innerHTML = `<strong>Resultado:</strong> O valor original antes do ${adjustmentType} de ${formatNumber(percentageAdjustment)}% era R$ ${formatNumber(originalValue)}`;
            resultElement.style.display = 'block';
            
            // Atualizar o campo de resultado
            resultInput.value = formatNumber(originalValue);
            resultContainer.style.display = 'flex';
        });
        
        // Botão de cópia para Valor Original
        document.getElementById('originalValueCopyButton').addEventListener('click', function() {
            const resultInput = document.getElementById('originalValueResultInput');
            copyToClipboard(resultInput.value, this);
        });
    </script>
</body>
</html>
